@font-face {
  font-family: "JetBrains Mono";
  src: url("./fonts/JetBrainsMono-Regular.ttf") format("truetype");
  font-weight: 400;
  font-style: normal;
  font-display: swap;
}

@font-face {
  font-family: "Noto Sans Symbols 2";
  src: url("./fonts/NotoSansSymbols2-Regular.ttf") format("truetype");
  font-weight: 400;
  font-style: normal;
  font-display: swap;
}

@font-face {
  font-family: "Symbols Nerd Font Mono";
  src: url("./fonts/SymbolsNerdFontMono-Regular.ttf") format("truetype");
  font-weight: 400;
  font-style: normal;
  font-display: swap;
}

/* ── Tokyonight color tokens ── */
:root {
  --tn-bg: #1a1b26;
  --tn-bg-dark: #16161e;
  --tn-bg-float: #1f2335;
  --tn-bg-highlight: #292e42;
  --tn-bg-selection: #283457;
  --tn-border: #29334d;
  --tn-fg: #c0caf5;
  --tn-fg-dark: #a9b1d6;
  --tn-fg-gutter: #3b4261;
  --tn-comment: #565f89;
  --tn-blue: #7aa2f7;
  --tn-cyan: #7dcfff;
  --tn-green: #9ece6a;
  --tn-magenta: #bb9af7;
  --tn-orange: #ff9e64;
  --tn-red: #f7768e;
  --tn-yellow: #e0af68;
  --tn-purple: #9d7cd8;
  --tn-teal: #1abc9c;
  color-scheme: dark;
  font-family: system-ui, -apple-system, sans-serif;
  font-size: 12px;
  background: var(--tn-bg);
  color: var(--tn-fg);
}

* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

body {
  position: relative;
  height: 100vh;
  overflow: hidden;
}

main {
  position: fixed;
  inset: 0;
  background: var(--tn-bg-dark);
  overflow: hidden;
  min-width: 0;
  min-height: 0;
}

/* ── Settings FAB ── */
.settings-fab-stack {
  position: fixed;
  right: 20px;
  bottom: 20px;
  z-index: 5000;
  display: inline-flex;
  flex-direction: column;
  align-items: center;
  gap: 8px;
}

.settings-fab {
  width: 44px;
  height: 44px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  border-radius: 999px;
  border: 1px solid var(--tn-border);
  background: rgba(26, 27, 38, 0.92);
  color: var(--tn-fg);
  backdrop-filter: blur(8px);
  box-shadow: 0 8px 30px rgba(0, 0, 0, 0.45);
  padding: 0;
  font-size: 0;
  line-height: 0;
  text-decoration: none;
  cursor: pointer;
}

.settings-fab:hover {
  background: var(--tn-bg-float);
}

.settings-fab-link {
  display: inline-flex;
}

.settings-fab-social {
  width: 36px;
  height: 36px;
}

.settings-fab-text {
  font-family: "JetBrains Mono", ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
  font-size: 12px;
  font-weight: 700;
  line-height: 1;
  letter-spacing: 0.02em;
  color: var(--tn-fg);
}

.settings-fab-social.settings-fab-text {
  font-size: 11px;
}

.settings-fab-icon {
  width: 23px;
  height: 23px;
  display: block;
  fill: currentColor;
}

.settings-fab-social .settings-fab-icon {
  width: 19px;
  height: 19px;
}

/* ── Settings dialog ── */
.settings-dialog {
  position: fixed;
  inset: auto 10px 74px auto;
  width: min(420px, calc(100vw - 20px));
  max-height: min(88vh, 820px);
  margin: 0;
  border: 0;
  padding: 0;
  background: transparent;
  color: inherit;
  overflow: visible;
}

.settings-dialog::backdrop {
  background: rgba(0, 0, 0, 0.38);
}

.settings-panel {
  width: 100%;
  max-height: min(88vh, 820px);
  border-radius: 12px;
  border: 1px solid var(--tn-border);
  box-shadow: 0 20px 54px rgba(0, 0, 0, 0.56);
}

@media (max-width: 640px) {
  .settings-fab-stack {
    right: 12px;
    bottom: 12px;
  }

  .settings-dialog {
    inset: auto 8px 64px 8px;
    width: auto;
    max-height: min(85vh, 760px);
  }
}

.settings-close {
  flex: 0 0 auto;
  width: 28px;
  height: 28px;
  border-radius: 999px;
  padding: 0;
  line-height: 1;
}

/* ── Panel ── */
.panel {
  display: flex;
  flex-direction: column;
  background: var(--tn-bg-float);
  overflow-y: auto;
}

header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 8px;
  padding: 10px 12px 9px;
  background: var(--tn-bg);
  border-bottom: 1px solid var(--tn-border);
  position: sticky;
  top: 0;
  z-index: 1;
}

header h1 {
  font-size: 13px;
  font-weight: 600;
  color: var(--tn-magenta);
}

.status-bar {
  display: flex;
  gap: 8px;
  font-size: 10px;
  color: var(--tn-comment);
  min-width: 0;
  flex: 1 1 auto;
}

.status-bar span:first-child {
  color: var(--tn-blue);
}

/* ── Sections ── */
.section {
  padding: 10px 12px;
  border-bottom: 1px solid var(--tn-border);
}

.panel > .section:last-child {
  border-bottom: 0;
}

.section-title {
  margin-bottom: 8px;
  font-size: 10px;
  font-weight: 600;
  color: var(--tn-comment);
  text-transform: uppercase;
  letter-spacing: 0.4px;
}

.row {
  display: flex;
  gap: 6px;
  margin-bottom: 6px;
}

.row:last-child {
  margin-bottom: 0;
}

.hint {
  font-size: 10px;
  color: var(--tn-fg-gutter);
  margin-top: 4px;
}

.btn-row,
.field-row {
  display: flex;
  gap: 6px;
}

.field-row {
  margin-top: 6px;
}

.field-row label {
  display: flex;
  flex: 1;
  align-items: center;
  gap: 6px;
  min-width: 0;
}

.field-row label > span {
  color: var(--tn-comment);
}

.file-input {
  position: relative;
  overflow: hidden;
}

.file-input input[type="file"] {
  position: absolute;
  inset: 0;
  opacity: 0;
  cursor: pointer;
}

.file-input span {
  display: inline-block;
  padding: 5px 8px;
  border: 1px solid var(--tn-border);
  border-radius: 3px;
  background: var(--tn-bg);
  color: var(--tn-fg);
}

.pty-status {
  margin-top: 6px;
  color: var(--tn-comment);
  font-size: 10px;
}

/* ── Controls ── */
button, select, input[type="text"], input[type="number"] {
  font-family: inherit;
  font-size: 11px;
  padding: 5px 8px;
  border: 1px solid var(--tn-border);
  border-radius: 3px;
  background: var(--tn-bg);
  color: var(--tn-fg);
  outline: none;
}

button {
  cursor: pointer;
}

button:hover {
  background: var(--tn-bg-highlight);
}

button:active {
  background: var(--tn-bg-selection);
}

select {
  flex: 1;
  min-width: 0;
}

input[type="text"] {
  flex: 1;
  min-width: 0;
}

input[type="number"] {
  width: 50px;
}

input[type="file"] {
  font-size: 10px;
  color: var(--tn-comment);
}

input:focus, select:focus {
  border-color: var(--tn-blue);
}

/* ── Session bar ── */
.session-bar {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  height: 24px;
  z-index: 4000;
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0 12px;
  background: rgba(26, 27, 38, 0.88);
  backdrop-filter: blur(6px);
  border-bottom: 1px solid var(--tn-border);
  font-size: 11px;
}

.session-bar #sessionName {
  color: var(--tn-blue);
  font-weight: 500;
}

.session-bar-link {
  font-size: 10px;
  padding: 2px 8px;
  border-radius: 10px;
  background: rgba(122, 162, 247, 0.08);
  border: 1px solid rgba(122, 162, 247, 0.15);
  color: var(--tn-comment);
  text-decoration: none;
  transition: background 0.15s, color 0.15s;
}

.session-bar-link:hover {
  background: rgba(122, 162, 247, 0.15);
  color: var(--tn-blue);
}

.session-bar-right {
  display: flex;
  align-items: center;
  gap: 8px;
}

.session-bar-hint {
  font-size: 9px;
  color: var(--tn-fg-gutter);
  letter-spacing: 0.3px;
}

.has-session-bar main {
  top: 24px;
}

/* ── Session switcher overlay ── */
.switcher-overlay {
  position: fixed;
  inset: 0;
  z-index: 9000;
  background: rgba(0, 0, 0, 0.55);
  backdrop-filter: blur(4px);
  display: flex;
  align-items: flex-start;
  justify-content: center;
  padding-top: min(15vh, 120px);
}

.switcher-panel {
  width: min(560px, calc(100vw - 32px));
  max-height: min(70vh, 520px);
  background: var(--tn-bg-float);
  border: 1px solid var(--tn-border);
  border-radius: 12px;
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.6);
  display: flex;
  flex-direction: column;
  overflow: hidden;
}

.switcher-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 10px 14px;
  border-bottom: 1px solid var(--tn-border);
}

.switcher-title {
  font-size: 12px;
  font-weight: 600;
  color: var(--tn-magenta);
}

.switcher-keys {
  font-size: 9px;
  color: var(--tn-fg-gutter);
}

.switcher-list {
  flex: 0 0 auto;
  max-height: 240px;
  overflow-y: auto;
  padding: 4px 0;
}

.switcher-item {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 8px 14px;
  cursor: pointer;
  transition: background 0.1s;
  font-size: 12px;
}

.switcher-item:hover {
  background: var(--tn-bg-highlight);
}

.switcher-item.selected {
  background: var(--tn-bg-selection);
}

.switcher-item.current {
  border-left: 2px solid var(--tn-blue);
  padding-left: 12px;
}

.switcher-dot {
  width: 6px;
  height: 6px;
  border-radius: 50%;
  flex-shrink: 0;
}

.switcher-dot.running { background: var(--tn-green); }
.switcher-dot.exited { background: var(--tn-red); }

.switcher-item-name {
  flex: 1;
  color: var(--tn-fg);
  font-weight: 500;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.switcher-item.selected .switcher-item-name {
  color: var(--tn-blue);
}

.switcher-item-meta {
  color: var(--tn-fg-gutter);
  font-size: 10px;
  white-space: nowrap;
}

.switcher-item-viewers {
  color: var(--tn-fg-gutter);
  font-size: 10px;
  white-space: nowrap;
}

.switcher-preview {
  flex: 1 1 auto;
  min-height: 80px;
  max-height: 200px;
  overflow: hidden;
  border-top: 1px solid var(--tn-border);
  padding: 8px 12px;
  font-family: "JetBrains Mono", ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
  font-size: 10px;
  line-height: 1.4;
  color: var(--tn-comment);
  background: var(--tn-bg-dark);
  white-space: pre;
  overflow-wrap: normal;
}

.switcher-preview:empty::after {
  content: "no output";
  color: var(--tn-fg-gutter);
}

.switcher-rename {
  padding: 8px 14px;
  border-top: 1px solid var(--tn-border);
  font-size: 11px;
  color: var(--tn-comment);
}

.switcher-rename input {
  font-family: inherit;
  font-size: 12px;
  padding: 4px 8px;
  background: var(--tn-bg-dark);
  border: 1px solid var(--tn-blue);
  border-radius: 4px;
  color: var(--tn-fg);
  outline: none;
  width: 240px;
  margin-left: 6px;
}

/* ── Switcher actions row ── */
.switcher-actions {
  display: flex;
  gap: 6px;
  padding: 8px 14px;
  border-top: 1px solid var(--tn-border);
}

.switcher-actions button {
  flex: 1;
  padding: 6px 12px;
  font-size: 11px;
  font-weight: 500;
  border: 1px solid var(--tn-border);
  border-radius: 6px;
  background: var(--tn-bg);
  color: var(--tn-fg-dark);
  cursor: pointer;
  transition: background 0.15s, border-color 0.15s;
}

.switcher-actions button:hover {
  background: var(--tn-bg-highlight);
  border-color: var(--tn-blue);
  color: var(--tn-blue);
}

.switcher-actions button.danger:hover {
  border-color: var(--tn-red);
  color: var(--tn-red);
}
